/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/@microsoft/signalr@3.1.0/dist/cjs/JsonHubProtocol.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var IHubProtocol_1=require("./IHubProtocol"),ILogger_1=require("./ILogger"),ITransport_1=require("./ITransport"),Loggers_1=require("./Loggers"),TextMessageFormat_1=require("./TextMessageFormat"),JSON_HUB_PROTOCOL_NAME="json",JsonHubProtocol=function(){function e(){this.name=JSON_HUB_PROTOCOL_NAME,this.version=1,this.transferFormat=ITransport_1.TransferFormat.Text}return e.prototype.parseMessages=function(e,o){if("string"!=typeof e)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!e)return[];null===o&&(o=Loggers_1.NullLogger.instance);for(var t=[],r=0,s=TextMessageFormat_1.TextMessageFormat.parse(e);r<s.length;r++){var a=s[r],n=JSON.parse(a);if("number"!=typeof n.type)throw new Error("Invalid payload.");switch(n.type){case IHubProtocol_1.MessageType.Invocation:this.isInvocationMessage(n);break;case IHubProtocol_1.MessageType.StreamItem:this.isStreamItemMessage(n);break;case IHubProtocol_1.MessageType.Completion:this.isCompletionMessage(n);break;case IHubProtocol_1.MessageType.Ping:case IHubProtocol_1.MessageType.Close:break;default:o.log(ILogger_1.LogLevel.Information,"Unknown message type '"+n.type+"' ignored.");continue}t.push(n)}return t},e.prototype.writeMessage=function(e){return TextMessageFormat_1.TextMessageFormat.write(JSON.stringify(e))},e.prototype.isInvocationMessage=function(e){this.assertNotEmptyString(e.target,"Invalid payload for Invocation message."),void 0!==e.invocationId&&this.assertNotEmptyString(e.invocationId,"Invalid payload for Invocation message.")},e.prototype.isStreamItemMessage=function(e){if(this.assertNotEmptyString(e.invocationId,"Invalid payload for StreamItem message."),void 0===e.item)throw new Error("Invalid payload for StreamItem message.")},e.prototype.isCompletionMessage=function(e){if(e.result&&e.error)throw new Error("Invalid payload for Completion message.");!e.result&&e.error&&this.assertNotEmptyString(e.error,"Invalid payload for Completion message."),this.assertNotEmptyString(e.invocationId,"Invalid payload for Completion message.")},e.prototype.assertNotEmptyString=function(e,o){if("string"!=typeof e||""===e)throw new Error(o)},e}();exports.JsonHubProtocol=JsonHubProtocol;
//# sourceMappingURL=/sm/b27560e03dfdced1e38ae7f075536c4cefa001fe643b8d56f3bdf49e73d4f9e8.map